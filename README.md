# Instagram í´ë¡  ì½”ë”©(Back-End)
Spring Boot + Reactë¥¼ ì´ìš©í•œ ì¸ìŠ¤íƒ€í¬ë¨ í´ë¡  ì½”ë”© í”„ë¡œì íŠ¸ 
- [\[ì‹œì—° ì˜ìƒ êµ¬ê²½í•˜ê¸°\]](https://www.youtube.com/watch?v=r8sIfu6DKtI&t=3s)
- [\[Front-End Repository\]](https://github.com/Hanghae99-CloneCoding/OutstarFrontReact)

## ğŸ‘¥ Member
<table>
    <tr>
        <td align="center">
        ë°•í˜•ê¸°<br>
         <a href="https://github.com/Denia-park"><img src="https://img.shields.io/badge/Github-181717?style=flat-square&logo=Github&logoColor=white"/></a>
        </td>
        <td align="center">
        ìœ í˜œë¯¼<br>
        <a href="https://github.com/hyemco"><img src="https://img.shields.io/badge/Github-181717?style=flat-square&logo=Github&logoColor=white"/></a>
        </td>
    </tr>
    <tr>
        <td align="center"> 
          íšŒì›ê°€ì…<br>
          ë¡œê·¸ì¸(JWT Token ì¸ì¦ ë°©ì‹)<br>
          ì†Œì…œ ë¡œê·¸ì¸(Kakao)
        </td>
        <td align="center">
          í˜ì´ì§€ë„¤ì´ì…˜(ë¬´í•œ ìŠ¤í¬ë¡¤)<br>
          í”¼ë“œ CRUD<br>
          ëŒ“ê¸€ CRUD<br>
          ë‹¤ì¤‘ ì´ë¯¸ì§€ íŒŒì¼ ì„œë²„(S3) ì—°ê²° ë° CRUD êµ¬í˜„
        </td>
    </tr>
</table>
<br>

## ğŸ—“ í”„ë¡œì íŠ¸ ê¸°ê°„
- 2022ë…„ 4ì›” 15ì¼ ~ 2022ë…„ 4ì›” 21ì¼
<br>

## âš™ï¸ ê¸°ìˆ  ìŠ¤íƒ

|ì œëª©|ë‚´ìš©|
|:---:|:---:|
|Language|<img src="https://img.shields.io/badge/Java-007396?style=flat-square&logo=java&logoColor=white"/>|
|Build|<img src="https://img.shields.io/badge/Gralde-02303A?style=flat-square&logo=Gradle&logoColor=white"/>|
|FrameWork|<img src="https://img.shields.io/badge/SpringBoot-6DB33F?style=flat-square&logo=springboot&logoColor=white"/>|
|DB|<img src="https://img.shields.io/badge/MySQL-4479A1?style=flat-square&logo=MySQL&logoColor=white"/>|
|Server|<img src="https://img.shields.io/badge/Amazon AWS-232F3E?style=flat-square&logo=Amazon AWS&logoColor=white"/> <img src="https://img.shields.io/badge/Amazon S3-569A31?style=flat-square&logo=Amazon S3&logoColor=white"/>|
<br>

## ğŸ’« í´ë¡  ê¸°ëŠ¥
> 1. íšŒì›ê°€ì… ë° ë¡œê·¸ì¸
+ Spring Security, JWT ì¸ì¦ ë°©ì‹ì„ ì‚¬ìš©í•œ ë¡œê·¸ì¸
+ Email, username ì¤‘ë³µí™•ì¸ ë° í•„ë“œë³„ ìœ íš¨ì„± ê²€ì‚¬
+ ì¹´ì¹´ì˜¤ ì†Œì…œ ë¡œê·¸ì¸ êµ¬í˜„(í”„ë¡ íŠ¸ì™€ ì—°ë™ X)

> 2. í”¼ë“œ CRUD
+ ë¡œê·¸ì¸í•œ ìœ ì €ë§Œ CRUD ê°€ëŠ¥
+ í”¼ë“œ ëª©ë¡ ì¡°íšŒ(ì‘ì„± ì‹œê°„ ê¸°ì¤€ ë‚´ë¦¼ì°¨ìˆœ)
+ ì¡°íšŒì‹œ ë¬´í•œ ìŠ¤í¬ë¡¤(í”„ë¡ íŠ¸ì™€ ì—°ë™ X)
+ ì—¬ëŸ¬ì¥ì˜ ì‚¬ì§„ê³¼ ë‚´ìš© ë“±ë¡
+ í”¼ë“œ ìˆ˜ì • ë° ì‚­ì œ(í”„ë¡ íŠ¸ì™€ ì—°ë™ X)

> 3. ëŒ“ê¸€ CRUD(í”„ë¡ íŠ¸ì™€ ì—°ë™ X)
+ ë¡œê·¸ì¸í•œ ìœ ì €ë§Œ CRUD ê°€ëŠ¥
+ í”¼ë“œë³„ ëŒ“ê¸€ ì¡°íšŒ
+ ëŒ“ê¸€ ì‘ì„± ë° ì‚­ì œ
<br>

## ğŸ—º ERD ì„¤ê³„
<img src="https://user-images.githubusercontent.com/98294357/164461136-1d552294-11d3-4332-913c-55696c50f75f.png" width="400"/>

<br>
                                                                                                                           
## ğŸ“Œ API ì„¤ê³„ ë° íšŒì˜ ìë£Œ
[\[ë…¸ì…˜ ë§í¬\]](https://www.notion.so/10-Instagram-b230f427624443d78f77b547f3152a53)
<br>
                                                                                                                           
## ğŸ’¡ Trouble Shooting
<details>                                                                                                                      
<summary>1. H2ì—ì„œ ìƒì„±ì´ ë˜ë˜ Tableì´ MySQLì— ì—°ê²°í•˜ë‹ˆ ìƒì„±ì´ ë˜ì§€ ì•ŠëŠ” ë¬¸ì œ</summary>
<br>
<div>
- ì›ì¸ : í…Œì´ë¸” ì»¬ëŸ¼ëª… ì¤‘ MySQL ì˜ˆì•½ì–´ ì¤‘ í•˜ë‚˜ì¸ "desc"ë¥¼ ì‚¬ìš©í•¨<br>
- í•´ê²° : "desc" ëŒ€ì‹  "content"ë¡œ ìˆ˜ì •                                                                                                                         
</div>
</details>                                                                                                                  

<details>                                                                                                                      
<summary>2. JWTë¥¼ ì‚¬ìš©í•˜ì—¬ SecurityContextHolderì— ìœ ì €ì •ë³´ë¥¼ ì €ì¥í–ˆëŠ”ë° @AuthorizationPrincipal UserDetails userDetails ì„ Controller ë©”ì„œë“œì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ì‚¬ìš©í•  ê²½ìš° ìœ ì € ì •ë³´ë¥¼ ì œëŒ€ë¡œ ê°€ì ¸ì˜¤ì§€ ëª»í•˜ëŠ” ë¬¸ì œ</summary>
<br>
<div>
- ì›ì¸ : SecurityContextHolderì— ì €ì¥í•œ ìœ ì €ì •ë³´ ì™€ @AuthorizationPrincipal UserDetails userDetails ëŠ” ë‹¤ë¥¸ ê°ì²´ ì´ë¯€ë¡œ @AuthorizationPrincipal UserDetail userDetail ë¥¼ í†µí•´ì„œ ìœ ì €ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ì—ˆìŒ<br>
- í•´ê²° : SecurityContextHolder.getContext().getAuthentication() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ì„œ ìœ ì €ì •ë³´ë¥¼ ê°€ì ¸ì˜´                                                                                                                         
</div>
</details>  

<details>                                                                                                                      
<summary>3. ì„œë²„ì—ì„œ JWTë¥¼ Headeì— ì¶”ê°€í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ë¡œ ë³´ë‚´ì¤¬ì§€ë§Œ FEì—ì„œ í•´ë‹¹ Headerë¥¼ ì½ì§€ ëª»í•˜ëŠ” ë¬¸ì œ (null ê°’ìœ¼ë¡œ ë°˜í™˜ë¨) [ê°œë°œìë„êµ¬ - ë„¤íŠ¸ì›Œí¬ Tab ì—ì„œëŠ” í—¤ë”ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŒ]</summary>
<br>
<div>
- ì›ì¸ : CORSì˜ ê²½ìš° ê¸°ë³¸ì ìœ¼ë¡œ í™”ë©´ì—ì„œ response header ê°’ì„ ì½ì§€ ëª»í•¨ (JavaScript ì½”ë“œì—ì„œ ì½ì„ ìˆ˜ ì—†ìŒ)<br>
- í•´ê²° : addCorsMappingsì—ì„œ .exposedHeaders("Authorization") ì„ ì¶”ê°€í•´ í™”ë©´ì—ì„œ ì§€ì •ëœ header ê°’("Authorization")ì„ ì½ì„ ìˆ˜ ìˆê²Œ í•¨                                                                                                                         
</div>
</details>                    

<details>                                                                                                                      
<summary>4. EC2ì— jar íŒŒì¼ì„ ì˜¬ë¦¬ê³  ì‹¤í–‰ì‹œ RSDë‘ ì—°ê²°ì´ ë˜ì§€ ì•ŠëŠ” ë¬¸ì œ</summary>
<br>
<div>
- Err Msg :  com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failure. The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server
- ì›ì¸ : RDS ì„œë²„ í†µì‹  ì—ëŸ¬<br>
- í•´ê²° : RDSì˜ DB ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚­ì œ í›„ ì¬ì„¤ì¹˜                                                                                                                         
</div>
</details>
                          
<details>                                                                                                                      
<summary>5. CORS ì „ì—­ ì²˜ë¦¬ë¥¼ í–ˆìŒì—ë„ íšŒì›ê°€ì…/ë¡œê·¸ì¸ ì´í›„ì— CORS ì—ëŸ¬ê°€ ê³„ì† ë°œìƒí•˜ëŠ” ë¬¸ì œ</summary>
<br>
<div>
- ì›ì¸ : Spring Securityì—ì„œ CORS ì¸ê°€ ì„¤ì •ì„ í•˜ì§€ ì•Šì•„ì„œ ë°œìƒ<br>
- í•´ê²° : CORS ì¸ê°€ ì²˜ë¦¬ë¥¼ í•´ì¤Œ
<div class="colorscripter-code" style="color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important;overflow:auto"><table class="colorscripter-code-table" style="margin:0;padding:0;border:none;background-color:#fafafa;border-radius:4px;" cellspacing="0" cellpadding="0"><tr><td style="padding:6px;border-right:2px solid #e5e5e5"><div style="margin:0;padding:0;word-break:normal;text-align:right;color:#666;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div></div></td><td style="padding:6px 0;text-align:left"><div style="margin:0;padding:0;color:#010101;font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important;line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%">@Override</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">protected</span>&nbsp;<span style="color:#a71d5d">void</span>&nbsp;configure(HttpSecurity&nbsp;httpSecurity)&nbsp;<span style="color:#a71d5d">throws</span>&nbsp;Exception&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;httpSecurity</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.cors()</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;.configurationSource(corsConfigurationSource());</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">@Bean</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">public</span>&nbsp;CorsConfigurationSource&nbsp;corsConfigurationSource()&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;CorsConfiguration&nbsp;configuration&nbsp;<span style="color:#0086b3"></span><span style="color:#a71d5d">=</span>&nbsp;<span style="color:#a71d5d">new</span>&nbsp;CorsConfiguration();&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;configuration.setAllowCredentials(<span style="color:#0099cc">true</span>)&nbsp;;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;configuration.addAllowedOriginPattern(<span style="color:#63a35c">"*"</span>);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;configuration.addAllowedOrigin(<span style="color:#63a35c">"http://localhost:3000"</span>);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;configuration.addAllowedMethod(<span style="color:#63a35c">"*"</span>);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;configuration.addAllowedHeader(<span style="color:#63a35c">"*"</span>);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;configuration.addExposedHeader(<span style="color:#63a35c">"Authorization"</span>);</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div></div><div style="text-align:right;margin-top:-13px;margin-right:5px;font-size:9px;font-style:italic"></div></td></tr></table></div>
</div>
</details>

